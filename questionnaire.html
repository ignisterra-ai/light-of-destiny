<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soul Blueprint Questionnaire - Personalize Your Report</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        .edition-badge {
            display: inline-block;
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 30px;
        }

        /* ‚ú® Assessment ÁµêÊûúÊ°Ü */
        .assessment-result-box {
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
            border: 3px solid #4CAF50;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
        }

        .assessment-result-box h3 {
            color: #2e7d32;
            font-size: 1.5em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .assessment-result-box .icon {
            font-size: 1.8em;
        }

        .saved-result {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .saved-result h4 {
            color: #667eea;
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .score-display {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .score-item {
            flex: 1;
            text-align: center;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        .score-item .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .score-item .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }

        /* ‚ö†Ô∏è Ê≤íÊúâ Assessment ÁöÑÊèêÁ§∫Ê°Ü */
        .no-assessment-box {
            background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%);
            border: 3px solid #ffc107;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
        }

        .no-assessment-box h3 {
            color: #856404;
            font-size: 1.3em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .no-assessment-box .icon {
            font-size: 1.5em;
        }

        .take-assessment-btn {
            display: inline-block;
            padding: 12px 24px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            margin-top: 15px;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .take-assessment-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        /* Ë°®ÂñÆÊ®£Âºè */
        .form-section {
            margin-bottom: 30px;
        }

        .form-section h2 {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1em;
        }

        label .required {
            color: #e74c3c;
        }

        input[type="text"],
        input[type="email"],
        input[type="date"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        /* Birth Date Inputs */
        .birth-date-inputs {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .birth-date-inputs input {
            flex: 1;
            text-align: center;
            padding: 12px 8px;
        }

        .birth-date-inputs input#birthYear {
            flex: 2;
        }

        .birth-date-inputs .separator {
            color: #999;
            font-weight: bold;
            font-size: 1.2em;
        }

        /* Èö±Ëóè number input ÁöÑ‰∏ä‰∏ãÁÆ≠È†≠ */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #f8f9ff, #e8ebff);
        }

        .help-text {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }

        .auto-filled-note {
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
            padding: 10px 15px;
            margin-top: 10px;
            border-radius: 5px;
            font-size: 0.9em;
            color: #2e7d32;
        }

        /* Êèê‰∫§ÊåâÈàï */
        .submit-section {
            margin-top: 40px;
            text-align: center;
        }

        .submit-btn {
            padding: 15px 50px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ÈüøÊáâÂºè */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            .score-display {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ú® Soul Blueprint Questionnaire</h1>
        <p class="subtitle">Tell us more about yourself to create your personalized report</p>
        
        <!-- È°ØÁ§∫ÈÅ∏ÊìáÁöÑÁâàÊú¨ -->
        <div style="text-align: center;">
            <span class="edition-badge" id="editionBadge">Loading...</span>
        </div>

        <!-- ‚ú® Assessment ÁµêÊûúÊ°ÜÔºàÂ¶ÇÊûúÊúâÁöÑË©±Ôºâ-->
        <div class="assessment-result-box" id="assessmentResultBox">
            <h3>
                <span class="icon">‚ú®</span>
                Great! We found your Assessment results!
            </h3>
            <p>We've automatically filled in your Soul Blueprint quadrant below. You can change it if needed.</p>
            
            <div class="saved-result">
                <h4 id="savedQuadrantName">Loading...</h4>
                <div class="score-display">
                    <div class="score-item">
                        <div class="label">3D Mastery</div>
                        <div class="value"><span id="saved3DScore">0</span>%</div>
                    </div>
                    <div class="score-item">
                        <div class="label">5D Awareness</div>
                        <div class="value"><span id="saved5DScore">0</span>%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ö†Ô∏è Ê≤íÊúâ Assessment ÁöÑÊèêÁ§∫Ê°Ü -->
        <div class="no-assessment-box" id="noAssessmentBox">
            <h3>
                <span class="icon">üí°</span>
                For the most accurate Soul Blueprint
            </h3>
            <p>We recommend taking our free Assessment first! It only takes 5 minutes and will give you the most personalized report.</p>
            <a href="assessment.html" class="take-assessment-btn">üìä Take Free Assessment</a>
            <p style="margin-top: 15px; color: #856404;">Or you can select your approximate quadrant below.</p>
        </div>

        <!-- Ë°®ÂñÆÈñãÂßã -->
        <form id="questionnaireForm">
            <!-- Section 1: Âü∫Êú¨Ë≥áÊñô -->
            <div class="form-section">
                <h2>üìù Basic Information</h2>
                
                <div class="form-group">
                    <label>
                        Full Name <span class="required">*</span>
                    </label>
                    <input type="text" id="fullName" name="fullName" required 
                           placeholder="Enter your full name">
                </div>

                <div class="form-group">
                    <label>
                        Email Address <span class="required">*</span>
                    </label>
                    <input type="email" id="email" name="email" required 
                           placeholder="your.email@example.com">
                    <div class="help-text">We'll send your Soul Blueprint report to this email</div>
                </div>

                <div class="form-group">
                    <label>
                        Birth Date <span class="required">*</span>
                    </label>
                    <div class="birth-date-inputs">
                        <input type="number" 
                               id="birthYear" 
                               name="birthYear" 
                               placeholder="YYYY" 
                               min="1900" 
                               max="2025" 
                               maxlength="4"
                               required>
                        <span class="separator">/</span>
                        <input type="number" 
                               id="birthMonth" 
                               name="birthMonth" 
                               placeholder="MM" 
                               min="1" 
                               max="12" 
                               maxlength="2"
                               required>
                        <span class="separator">/</span>
                        <input type="number" 
                               id="birthDay" 
                               name="birthDay" 
                               placeholder="DD" 
                               min="1" 
                               max="31" 
                               maxlength="2"
                               required>
                    </div>
                    <div class="help-text">Used for deeper astrological insights</div>
                </div>
            </div>

            <!-- Section 2: Soul Blueprint Assessment -->
            <div class="form-section">
                <h2>üåü Your Soul Blueprint Quadrant</h2>
                
                <div class="form-group">
                    <label>
                        Your Soul Blueprint Assessment Result <span class="required">*</span>
                    </label>
                    
                    <div class="auto-filled-note" id="autoFilledNote" style="display: none;">
                        ‚ú® Auto-filled from your Assessment. You can change it if needed.
                    </div>
                    
                    <div class="radio-group" id="quadrantRadioGroup">
                        <label class="radio-option">
                            <input type="radio" name="quadrant" value="light-keeper" required>
                            <span>üïäÔ∏è <strong>Light Keeper</strong> - The Beacon (High 3D, High 5D)</span>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="quadrant" value="bridge-builder" required>
                            <span>üåâ <strong>Bridge Builder</strong> - The Integrator (Balanced)</span>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="quadrant" value="phoenix" required>
                            <span>üî• <strong>Phoenix</strong> - The Transformer (High 5D, Growing 3D)</span>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="quadrant" value="seeker" required>
                            <span>üå± <strong>Seeker</strong> - The Explorer (Awakening)</span>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="quadrant" value="not-taken">
                            <span>‚ùì <strong>I haven't taken the assessment</strong> 
                                <a href="assessment.html" style="color: #667eea; text-decoration: underline; font-weight: normal;">(Take it now - 5 min)</a>
                            </span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Section 3: ‰∏âÂÄãÂõ∞ÊÉë -->
            <div class="form-section">
                <h2>üí≠ Your Current Challenges</h2>
                <p style="color: #666; margin-bottom: 20px;">
                    Share 3 specific challenges or questions you're facing. This helps us personalize your report.
                </p>
                
                <div class="form-group">
                    <label>Challenge #1 <span class="required">*</span></label>
                    <textarea id="challenge1" name="challenge1" required 
                              placeholder="Example: I feel stuck in my career and don't know what direction to take..."></textarea>
                </div>

                <div class="form-group">
                    <label>Challenge #2 <span class="required">*</span></label>
                    <textarea id="challenge2" name="challenge2" required 
                              placeholder="Example: I struggle to balance my spiritual growth with daily responsibilities..."></textarea>
                </div>

                <div class="form-group">
                    <label>Challenge #3 <span class="required">*</span></label>
                    <textarea id="challenge3" name="challenge3" required 
                              placeholder="Example: I want to manifest my dreams but keep hitting roadblocks..."></textarea>
                </div>
            </div>

            <!-- Section 4: ÂÖ∂‰ªñË≥áÊñôÔºàÂèØÈÅ∏Ôºâ-->
            <div class="form-section">
                <h2>üåà Additional Information (Optional)</h2>
                
                <div class="form-group">
                    <label>Current Life Stage</label>
                    <select id="lifeStage" name="lifeStage">
                        <option value="">Select one...</option>
                        <option value="early-career">Early Career (20s)</option>
                        <option value="establishing">Establishing (30s)</option>
                        <option value="mastery">Mastery Phase (40s)</option>
                        <option value="wisdom">Wisdom Years (50+)</option>
                        <option value="transition">In Transition</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>What brings you here today?</label>
                    <textarea id="motivation" name="motivation" 
                              placeholder="What prompted you to seek your Soul Blueprint? What are you hoping to discover or change?"></textarea>
                </div>

                <div class="form-group">
                    <label>Any specific areas you want us to focus on?</label>
                    <textarea id="focusAreas" name="focusAreas" 
                              placeholder="Career, relationships, spiritual growth, health, life purpose, etc."></textarea>
                </div>
            </div>

            <!-- Êèê‰∫§ÊåâÈàï -->
            <div class="submit-section">
                <button type="submit" class="submit-btn">
                    Continue to Preview üöÄ
                </button>
            </div>
        </form>
    </div>

    <script>
        // ==========================================
        // üöÄ È†ÅÈù¢ËºâÂÖ•ÊôÇÂü∑Ë°å
        // ==========================================
        document.addEventListener('DOMContentLoaded', function() {
            // 1. Âæû URL ÂèñÂæó edition ÂèÉÊï∏
            loadEditionFromURL();
            
            // 2. ‚ú® Ëá™ÂãïËºâÂÖ• Assessment ÁµêÊûú
            loadAssessmentResults();
            
            // 3. ‚ú® Ëá™ÂãïÂ°´ÂÖ•‰πãÂâçÂ°´ÂØ´ÁöÑË≥áÊñôÔºàÂ¶ÇÊûúÊúâÁöÑË©±Ôºâ
            loadPreviousFormData();
            
            // 4. Ë®≠ÂÆö Radio ÈÅ∏È†ÖÁöÑ‰∫íÂãïÊïàÊûú
            setupRadioInteractions();
            
            // 5. Ë®≠ÂÆöÁîüÊó•Ëº∏ÂÖ•Ê°ÜËá™ÂãïË∑≥ËΩâ
            setupBirthDateAutoJump();
            
            // 6. Ë®≠ÂÆöË°®ÂñÆÊèê‰∫§
            setupFormSubmit();
        });

        // ==========================================
        // üìã ËºâÂÖ•ÁâàÊú¨Ë≥áË®ä
        // ==========================================
        function loadEditionFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const edition = urlParams.get('edition') || 'seed';
            
            const editionNames = {
                'seed': 'üå± Seed Edition',
                'bloom': 'üå∏ Bloom Edition',
                'legacy': 'üëë Legacy Edition'
            };
            
            document.getElementById('editionBadge').textContent = editionNames[edition] || 'üå± Seed Edition';
            
            // ÂÑ≤Â≠òÂà∞Èö±ËóèÊ¨Ñ‰ΩçÔºàÁ®çÂæåÊúÉÂä†Ôºâ
            sessionStorage.setItem('selectedEdition', edition);
        }

        // ==========================================
        // ‚ú® Ëá™ÂãïËºâÂÖ• Assessment ÁµêÊûú
        // ==========================================
        function loadAssessmentResults() {
            const savedData = localStorage.getItem('soulBlueprintAssessment');
            
            if (savedData) {
                try {
                    const assessment = JSON.parse(savedData);
                    console.log('‚úÖ Found saved assessment:', assessment);
                    
                    // È°ØÁ§∫ÊàêÂäüÊ°Ü
                    document.getElementById('assessmentResultBox').style.display = 'block';
                    document.getElementById('noAssessmentBox').style.display = 'none';
                    
                    // Â°´ÂÖ•Ë≥áÊñô
                    document.getElementById('savedQuadrantName').textContent = assessment.quadrantName;
                    document.getElementById('saved3DScore').textContent = assessment.mastery3D;
                    document.getElementById('saved5DScore').textContent = assessment.awareness5D;
                    
                    // È°ØÁ§∫Ëá™ÂãïÂ°´ÂÖ•ÊèêÁ§∫
                    document.getElementById('autoFilledNote').style.display = 'block';
                    
                    // ‚ú® Ëá™ÂãïÈÅ∏‰∏≠Â∞çÊáâÁöÑË±°Èôê
                    const quadrantMap = {
                        1: 'light-keeper',
                        2: 'bridge-builder',
                        3: 'phoenix',
                        4: 'seeker'
                    };
                    
                    const quadrantValue = quadrantMap[assessment.quadrant];
                    if (quadrantValue) {
                        const radioButton = document.querySelector(`input[name="quadrant"][value="${quadrantValue}"]`);
                        if (radioButton) {
                            radioButton.checked = true;
                            radioButton.closest('.radio-option').classList.add('selected');
                        }
                    }
                    
                    return true;
                } catch (e) {
                    console.error('‚ùå Error parsing assessment data:', e);
                    showNoAssessmentBox();
                    return false;
                }
            } else {
                console.log('‚ÑπÔ∏è No saved assessment found');
                showNoAssessmentBox();
                return false;
            }
        }

        // È°ØÁ§∫„ÄåÊ≤íÊúâ Assessment„ÄçÁöÑÊèêÁ§∫Ê°Ü
        function showNoAssessmentBox() {
            document.getElementById('assessmentResultBox').style.display = 'none';
            document.getElementById('noAssessmentBox').style.display = 'block';
            document.getElementById('autoFilledNote').style.display = 'none';
        }

        // ==========================================
        // üíæ ËºâÂÖ•‰πãÂâçÂ°´ÂØ´ÁöÑË≥áÊñô
        // ==========================================
        function loadPreviousFormData() {
            const savedData = sessionStorage.getItem('questionnaireData');
            
            if (!savedData) {
                console.log('‚ÑπÔ∏è No previous form data found');
                return;
            }

            try {
                const data = JSON.parse(savedData);
                console.log('‚úÖ Loading previous form data:', data);

                // Â°´ÂÖ•Âü∫Êú¨Ë≥áÊñô
                if (data.fullName) document.getElementById('fullName').value = data.fullName;
                if (data.email) document.getElementById('email').value = data.email;
                if (data.birthDate) {
                    // ÊãÜÂàÜÁîüÊó• (Ê†ºÂºè: YYYY-MM-DD)
                    const [year, month, day] = data.birthDate.split('-');
                    if (year) document.getElementById('birthYear').value = year;
                    if (month) document.getElementById('birthMonth').value = month;
                    if (day) document.getElementById('birthDay').value = day;
                }

                // Â°´ÂÖ•Ë±°ÈôêÔºàÂ¶ÇÊûúÊ≤íÊúâ assessment ÁöÑË©±Ôºâ
                if (data.quadrant && !localStorage.getItem('soulBlueprintAssessment')) {
                    const radioButton = document.querySelector(`input[name="quadrant"][value="${data.quadrant}"]`);
                    if (radioButton) {
                        radioButton.checked = true;
                        radioButton.closest('.radio-option').classList.add('selected');
                    }
                }

                // Â°´ÂÖ•‰∏âÂÄãÂõ∞ÊÉë
                if (data.challenges) {
                    if (data.challenges[0]) document.getElementById('challenge1').value = data.challenges[0];
                    if (data.challenges[1]) document.getElementById('challenge2').value = data.challenges[1];
                    if (data.challenges[2]) document.getElementById('challenge3').value = data.challenges[2];
                }

                // Â°´ÂÖ•ÂèØÈÅ∏Ë≥áÊñô
                if (data.lifeStage) document.getElementById('lifeStage').value = data.lifeStage;
                if (data.motivation) document.getElementById('motivation').value = data.motivation;
                if (data.focusAreas) document.getElementById('focusAreas').value = data.focusAreas;

                console.log('‚úÖ Previous form data loaded successfully');

            } catch (e) {
                console.error('‚ùå Failed to load previous form data:', e);
            }
        }

        // ==========================================
        // üé® Ë®≠ÂÆö Radio ÈÅ∏È†ÖÁöÑË¶ñË¶∫ÊïàÊûú
        // ==========================================
        function setupRadioInteractions() {
            const radioOptions = document.querySelectorAll('.radio-option');
            
            radioOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // ÁßªÈô§ÊâÄÊúâÈÅ∏‰∏≠ÁãÄÊÖã
                    radioOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Ê∑ªÂä†Áï∂ÂâçÈÅ∏‰∏≠ÁãÄÊÖã
                    this.classList.add('selected');
                    
                    // ÈÅ∏‰∏≠Â∞çÊáâÁöÑ radio button
                    const radio = this.querySelector('input[type="radio"]');
                    radio.checked = true;
                });
            });
        }

        // ==========================================
        // üìÖ Ë®≠ÂÆöÁîüÊó•Ëº∏ÂÖ•Ê°ÜËá™ÂãïË∑≥ËΩâ
        // ==========================================
        function setupBirthDateAutoJump() {
            const yearInput = document.getElementById('birthYear');
            const monthInput = document.getElementById('birthMonth');
            const dayInput = document.getElementById('birthDay');

            // Âπ¥‰ªΩËº∏ÂÖ•ÂÆåÊàêÂæåËá™ÂãïË∑≥Âà∞Êúà‰ªΩ
            yearInput.addEventListener('input', function(e) {
                const value = this.value;
                
                // ÈôêÂà∂Âè™ËÉΩËº∏ÂÖ• 4 ‰ΩçÊï∏Â≠ó
                if (value.length > 4) {
                    this.value = value.slice(0, 4);
                }
                
                // Ëº∏ÂÖ•ÂÆå 4 ‰ΩçÊï∏Â≠óÂæåËá™ÂãïË∑≥Âà∞Êúà‰ªΩ
                if (value.length === 4) {
                    monthInput.focus();
                }
            });

            // Êúà‰ªΩËº∏ÂÖ•ÂÆåÊàêÂæåËá™ÂãïË∑≥Âà∞Êó•Êúü
            monthInput.addEventListener('input', function(e) {
                const value = this.value;
                
                // ÈôêÂà∂Âè™ËÉΩËº∏ÂÖ• 2 ‰ΩçÊï∏Â≠ó
                if (value.length > 2) {
                    this.value = value.slice(0, 2);
                }
                
                // Ëá™ÂãïË£ú 0Ôºà‰æãÂ¶ÇÔºöËº∏ÂÖ• 5 ‚Üí 05Ôºâ
                if (value.length === 1 && parseInt(value) > 1) {
                    this.value = '0' + value;
                    dayInput.focus();
                }
                
                // Ëº∏ÂÖ•ÂÆå 2 ‰ΩçÊï∏Â≠óÂæåËá™ÂãïË∑≥Âà∞Êó•Êúü
                if (value.length === 2) {
                    // È©óË≠âÊúà‰ªΩÁØÑÂúç
                    const month = parseInt(value);
                    if (month >= 1 && month <= 12) {
                        dayInput.focus();
                    } else {
                        this.value = '';
                        alert('Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊúà‰ªΩ (01-12)');
                    }
                }
            });

            // Êó•ÊúüËº∏ÂÖ•È©óË≠â
            dayInput.addEventListener('input', function(e) {
                const value = this.value;
                
                // ÈôêÂà∂Âè™ËÉΩËº∏ÂÖ• 2 ‰ΩçÊï∏Â≠ó
                if (value.length > 2) {
                    this.value = value.slice(0, 2);
                }
                
                // Ëá™ÂãïË£ú 0Ôºà‰æãÂ¶ÇÔºöËº∏ÂÖ• 5 ‚Üí 05Ôºâ
                if (value.length === 1 && parseInt(value) > 3) {
                    this.value = '0' + value;
                }
                
                // È©óË≠âÊó•ÊúüÁØÑÂúç
                if (value.length === 2) {
                    const day = parseInt(value);
                    if (day < 1 || day > 31) {
                        this.value = '';
                        alert('Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊó•Êúü (01-31)');
                    }
                }
            });

            // ÊîØÊè¥ÈÄÄÊ†ºÈçµËøîÂõû‰∏ä‰∏ÄÂÄãËº∏ÂÖ•Ê°Ü
            monthInput.addEventListener('keydown', function(e) {
                if (e.key === 'Backspace' && this.value === '') {
                    yearInput.focus();
                }
            });

            dayInput.addEventListener('keydown', function(e) {
                if (e.key === 'Backspace' && this.value === '') {
                    monthInput.focus();
                }
            });
        }

        // ==========================================
        // üì§ Ë®≠ÂÆöË°®ÂñÆÊèê‰∫§
        // ==========================================
        function setupFormSubmit() {
            const form = document.getElementById('questionnaireForm');
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Êî∂ÈõÜË°®ÂñÆË≥áÊñô
                const formData = {
                    // Âü∫Êú¨Ë≥áÊñô
                    fullName: document.getElementById('fullName').value,
                    email: document.getElementById('email').value,
                    birthDate: `${document.getElementById('birthYear').value}-${document.getElementById('birthMonth').value.padStart(2, '0')}-${document.getElementById('birthDay').value.padStart(2, '0')}`,
                    
                    // Soul Blueprint
                    quadrant: document.querySelector('input[name="quadrant"]:checked').value,
                    
                    // ‰∏âÂÄãÂõ∞ÊÉë
                    challenges: [
                        document.getElementById('challenge1').value,
                        document.getElementById('challenge2').value,
                        document.getElementById('challenge3').value
                    ],
                    
                    // ÂèØÈÅ∏Ë≥áÊñô
                    lifeStage: document.getElementById('lifeStage').value,
                    motivation: document.getElementById('motivation').value,
                    focusAreas: document.getElementById('focusAreas').value,
                    
                    // Edition
                    edition: sessionStorage.getItem('selectedEdition'),
                    
                    // Assessment Ë≥áÊñôÔºàÂ¶ÇÊûúÊúâÁöÑË©±Ôºâ
                    assessmentData: localStorage.getItem('soulBlueprintAssessment')
                };
                
                console.log('üì§ Form submitted:', formData);
                
                // ÂÑ≤Â≠òÂà∞ sessionStorageÔºåÁµ¶ preview.html ‰ΩøÁî®
                sessionStorage.setItem('questionnaireData', JSON.stringify(formData));
                
                // Â∞éÂêëÂà∞ preview.html
                window.location.href = 'preview.html';
            });
        }
    </script>
    <script src="i18n.js"></script>
</body>
</html>
